const n=Symbol.for("drizzle:entityKind");function w(r,e){if(!r||typeof r!="object")return!1;if(r instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,n))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let t=Object.getPrototypeOf(r).constructor;if(t)for(;t;){if(n in t&&t[n]===e[n])return!0;t=Object.getPrototypeOf(t)}return!1}class j{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.keyAsName=t.keyAsName,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity}static[n]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}class ne{static[n]="ColumnBuilder";config;constructor(e,t,i){this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:i,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}}const x=Symbol.for("drizzle:Name");class se{static[n]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{const{name:i,columns:o,foreignColumns:a}=e();return{name:i,columns:o,foreignTable:a[0].table,foreignColumns:a}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new oe(e,this)}}class oe{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static[n]="PgForeignKey";reference;onUpdate;onDelete;getName(){const{name:e,columns:t,foreignColumns:i}=this.reference(),o=t.map(y=>y.name),a=i.map(y=>y.name),p=[this.table[x],...o,i[0].table[x],...a];return e??`${p.join("_")}_fk`}}function ae(r,...e){return r(...e)}function ue(r,e){return`${r[x]}_${e.join("_")}_unique`}function K(r,e,t){for(let i=e;i<r.length;i++){const o=r[i];if(o==="\\"){i++;continue}if(o==='"')return[r.slice(e,i).replace(/\\/g,""),i+1];if(!t&&(o===","||o==="}"))return[r.slice(e,i).replace(/\\/g,""),i]}return[r.slice(e).replace(/\\/g,""),r.length]}function X(r,e=0){const t=[];let i=e,o=!1;for(;i<r.length;){const a=r[i];if(a===","){(o||i===e)&&t.push(""),o=!0,i++;continue}if(o=!1,a==="\\"){i+=2;continue}if(a==='"'){const[g,f]=K(r,i+1,!0);t.push(g),i=f;continue}if(a==="}")return[t,i+1];if(a==="{"){const[g,f]=X(r,i+1);t.push(g),i=f;continue}const[p,y]=K(r,i,!1);t.push(p),i=y}return[t,i]}function le(r){const[e]=X(r,1);return e}function Y(r){return`{${r.map(e=>Array.isArray(e)?Y(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}class l extends ne{foreignKeyConfigs=[];static[n]="PgColumnBuilder";array(e){return new me(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:i,actions:o})=>ae((a,p)=>{const y=new se(()=>{const g=a();return{columns:[e],foreignColumns:[g]}});return p.onUpdate&&y.onUpdate(p.onUpdate),p.onDelete&&y.onDelete(p.onDelete),y.build(t)},i,o))}buildExtraConfigColumn(e){return new ce(e,this.config)}}class u extends j{constructor(e,t){t.uniqueName||(t.uniqueName=ue(e,[t.name])),super(e,t),this.table=e}static[n]="PgColumn"}class ce extends u{static[n]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}}class me extends l{static[n]="PgArrayBuilder";constructor(e,t,i){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=i}build(e){const t=this.config.baseBuilder.build(e);return new U(e,this.config,t)}}class U extends u{constructor(e,t,i,o){super(e,t),this.baseColumn=i,this.range=o,this.size=t.size}size;static[n]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=le(e)),e.map(t=>this.baseColumn.mapFromDriverValue(t))}mapToDriverValue(e,t=!1){const i=e.map(o=>o===null?null:w(this.baseColumn,U)?this.baseColumn.mapToDriverValue(o,!0):this.baseColumn.mapToDriverValue(o));return t?i:Y(i)}}const E=Symbol.for("drizzle:isPgEnum");function ge(r){return!!r&&typeof r=="function"&&E in r&&r[E]===!0}class Z{static[n]="Subquery";constructor(e,t,i,o=!1,a=[]){this._={brand:"Subquery",sql:e,selectedFields:t,alias:i,isWith:o,usedTables:a}}}const de={startActiveSpan(r,e){return e()}},D=Symbol.for("drizzle:ViewBaseConfig"),L=Symbol.for("drizzle:Schema"),J=Symbol.for("drizzle:Columns"),G=Symbol.for("drizzle:ExtraConfigColumns"),Q=Symbol.for("drizzle:OriginalName"),$=Symbol.for("drizzle:BaseName"),v=Symbol.for("drizzle:IsAlias"),M=Symbol.for("drizzle:ExtraConfigBuilder"),pe=Symbol.for("drizzle:IsDrizzleTable");class b{static[n]="Table";static Symbol={Name:x,Schema:L,OriginalName:Q,Columns:J,ExtraConfigColumns:G,BaseName:$,IsAlias:v,ExtraConfigBuilder:M};[x];[Q];[L];[J];[G];[$];[v]=!1;[pe]=!0;[M]=void 0;constructor(e,t,i){this[x]=this[Q]=e,this[L]=t,this[$]=i}}function fe(r){return r!=null&&typeof r.getSQL=="function"}function he(r){const e={sql:"",params:[]};for(const t of r)e.sql+=t.sql,e.params.push(...t.params),t.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...t.typings));return e}class B{static[n]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new h([this])}}class h{constructor(e){this.queryChunks=e;for(const t of e)if(w(t,b)){const i=t[b.Symbol.Schema];this.usedTables.push(i===void 0?t[b.Symbol.Name]:i+"."+t[b.Symbol.Name])}}static[n]="SQL";decoder=k;shouldInlineParams=!1;usedTables=[];append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return de.startActiveSpan("drizzle.buildSQL",t=>{const i=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":i.sql,"drizzle.query.params":JSON.stringify(i.params)}),i})}buildQueryFromSourceParams(e,t){const i=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{casing:o,escapeName:a,escapeParam:p,prepareTyping:y,inlineParams:g,paramStartIndex:f}=i;return he(e.map(s=>{if(w(s,B))return{sql:s.value.join(""),params:[]};if(w(s,A))return{sql:a(s.value),params:[]};if(s===void 0)return{sql:"",params:[]};if(Array.isArray(s)){const m=[new B("(")];for(const[d,N]of s.entries())m.push(N),d<s.length-1&&m.push(new B(", "));return m.push(new B(")")),this.buildQueryFromSourceParams(m,i)}if(w(s,h))return this.buildQueryFromSourceParams(s.queryChunks,{...i,inlineParams:g||s.shouldInlineParams});if(w(s,b)){const m=s[b.Symbol.Schema],d=s[b.Symbol.Name];return{sql:m===void 0||s[v]?a(d):a(m)+"."+a(d),params:[]}}if(w(s,j)){const m=o.getColumnCasing(s);if(t.invokeSource==="indexes")return{sql:a(m),params:[]};const d=s.table[b.Symbol.Schema];return{sql:s.table[v]||d===void 0?a(s.table[b.Symbol.Name])+"."+a(m):a(d)+"."+a(s.table[b.Symbol.Name])+"."+a(m),params:[]}}if(w(s,Pe)){const m=s[D].schema,d=s[D].name;return{sql:m===void 0||s[D].isAlias?a(d):a(m)+"."+a(d),params:[]}}if(w(s,te)){if(w(s.value,q))return{sql:p(f.value++,s),params:[s],typings:["none"]};const m=s.value===null?null:s.encoder.mapToDriverValue(s.value);if(w(m,h))return this.buildQueryFromSourceParams([m],i);if(g)return{sql:this.mapInlineParam(m,i),params:[]};let d=["none"];return y&&(d=[y(s.encoder)]),{sql:p(f.value++,m),params:[m],typings:d}}return w(s,q)?{sql:p(f.value++,s),params:[s],typings:["none"]}:w(s,h.Aliased)&&s.fieldAlias!==void 0?{sql:a(s.fieldAlias),params:[]}:w(s,Z)?s._.isWith?{sql:a(s._.alias),params:[]}:this.buildQueryFromSourceParams([new B("("),s._.sql,new B(") "),new A(s._.alias)],i):ge(s)?s.schema?{sql:a(s.schema)+"."+a(s.enumName),params:[]}:{sql:a(s.enumName),params:[]}:fe(s)?s.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([s.getSQL()],i):this.buildQueryFromSourceParams([new B("("),s.getSQL(),new B(")")],i):g?{sql:this.mapInlineParam(s,i),params:[]}:{sql:p(f.value++,s),params:[s],typings:["none"]}}))}mapInlineParam(e,{escapeString:t}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return t(e);if(typeof e=="object"){const i=e.toString();return t(i==="[object Object]"?JSON.stringify(e):i)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new h.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}}class A{constructor(e){this.value=e}static[n]="Name";brand;getSQL(){return new h([this])}}const k={mapFromDriverValue:r=>r},ee={mapToDriverValue:r=>r};({...k,...ee});class te{constructor(e,t=ee){this.value=e,this.encoder=t}static[n]="Param";brand;getSQL(){return new h([this])}}function I(r,...e){const t=[];(e.length>0||r.length>0&&r[0]!=="")&&t.push(new B(r[0]));for(const[i,o]of e.entries())t.push(o,new B(r[i+1]));return new h(t)}(r=>{function e(){return new h([])}r.empty=e;function t(g){return new h(g)}r.fromList=t;function i(g){return new h([new B(g)])}r.raw=i;function o(g,f){const s=[];for(const[m,d]of g.entries())m>0&&f!==void 0&&s.push(f),s.push(d);return new h(s)}r.join=o;function a(g){return new A(g)}r.identifier=a;function p(g){return new q(g)}r.placeholder=p;function y(g,f){return new te(g,f)}r.param=y})(I||(I={}));(r=>{class e{constructor(i,o){this.sql=i,this.fieldAlias=o}static[n]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}r.Aliased=e})(h||(h={}));class q{constructor(e){this.name=e}static[n]="Placeholder";getSQL(){return new h([this])}}const ye=Symbol.for("drizzle:IsDrizzleView");class Pe{static[n]="View";[D];[ye]=!0;constructor({name:e,schema:t,selectedFields:i,query:o}){this[D]={name:e,originalName:e,schema:t,selectedFields:i,query:o,isExisting:!o,isAlias:!1}}getSQL(){return new h([this])}}j.prototype.getSQL=function(){return new h([this])};b.prototype.getSQL=function(){return new h([this])};Z.prototype.getSQL=function(){return new h([this])};function P(r,e){return{name:typeof r=="string"&&r.length>0?r:"",config:typeof r=="object"?r:e}}class F extends l{static[n]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){const{name:t,...i}=e;this.config.generatedIdentity={type:"always",sequenceName:t,sequenceOptions:i}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){const{name:t,...i}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:t,sequenceOptions:i}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}class be extends F{static[n]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new we(e,this.config)}}class we extends u{static[n]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}}class Se extends F{static[n]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new Be(e,this.config)}}class Be extends u{static[n]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}function Te(r,e){const{name:t,config:i}=P(r,e);return i.mode==="number"?new be(t):new Se(t)}class Ne extends l{static[n]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new xe(e,this.config)}}class xe extends u{static[n]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}}class De extends l{static[n]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new Ce(e,this.config)}}class Ce extends u{static[n]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}function Ve(r,e){const{name:t,config:i}=P(r,e);return i.mode==="number"?new Ne(t):new De(t)}class ve extends l{static[n]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new Ie(e,this.config)}}class Ie extends u{static[n]="PgBoolean";getSQLType(){return"boolean"}}function re(r){return new ve(r??"")}class Fe extends l{static[n]="PgCharBuilder";constructor(e,t){super(e,"string","PgChar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new ze(e,this.config)}}class ze extends u{static[n]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}function Le(r,e={}){const{name:t,config:i}=P(r,e);return new Fe(t,i)}class Qe extends l{static[n]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new $e(e,this.config)}}class $e extends u{static[n]="PgCidr";getSQLType(){return"cidr"}}function Ae(r){return new Qe(r??"")}class qe extends l{static[n]="PgCustomColumnBuilder";constructor(e,t,i){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=i}build(e){return new _e(e,this.config)}}class _e extends u{static[n]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}}function Oe(r){return(e,t)=>{const{name:i,config:o}=P(e,t);return new qe(i,o,r)}}class C extends l{static[n]="PgDateColumnBaseBuilder";defaultNow(){return this.default(I`now()`)}}class je extends C{static[n]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new Ue(e,this.config)}}class Ue extends u{static[n]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}}class Ke extends C{static[n]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new Ee(e,this.config)}}class Ee extends u{static[n]="PgDateString";getSQLType(){return"date"}}function Je(r,e){const{name:t,config:i}=P(r,e);return i?.mode==="date"?new je(t):new Ke(t)}class Ge extends l{static[n]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new Me(e,this.config)}}class Me extends u{static[n]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}}function Re(r){return new Ge(r??"")}class He extends l{static[n]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new We(e,this.config)}}class We extends u{static[n]="PgInet";getSQLType(){return"inet"}}function Xe(r){return new He(r??"")}class Ye extends F{static[n]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new Ze(e,this.config)}}class Ze extends u{static[n]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}}function _(r){return new Ye(r??"")}class ke extends l{static[n]="PgIntervalBuilder";constructor(e,t){super(e,"string","PgInterval"),this.config.intervalConfig=t}build(e){return new et(e,this.config)}}class et extends u{static[n]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){const e=this.fields?` ${this.fields}`:"",t=this.precision?`(${this.precision})`:"";return`interval${e}${t}`}}function tt(r,e={}){const{name:t,config:i}=P(r,e);return new ke(t,i)}class rt extends l{static[n]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new it(e,this.config)}}class it extends u{static[n]="PgJson";constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}function nt(r){return new rt(r??"")}class st extends l{static[n]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new ot(e,this.config)}}class ot extends u{static[n]="PgJsonb";constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}function at(r){return new st(r??"")}class ut extends l{static[n]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new lt(e,this.config)}}class lt extends u{static[n]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){const[t,i,o]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(i),Number.parseFloat(o)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}}class ct extends l{static[n]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new mt(e,this.config)}}class mt extends u{static[n]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){const[t,i,o]=e.slice(1,-1).split(",");return{a:Number.parseFloat(t),b:Number.parseFloat(i),c:Number.parseFloat(o)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}function gt(r,e){const{name:t,config:i}=P(r,e);return!i?.mode||i.mode==="tuple"?new ut(t):new ct(t)}class dt extends l{static[n]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new pt(e,this.config)}}class pt extends u{static[n]="PgMacaddr";getSQLType(){return"macaddr"}}function ft(r){return new dt(r??"")}class ht extends l{static[n]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new yt(e,this.config)}}class yt extends u{static[n]="PgMacaddr8";getSQLType(){return"macaddr8"}}function Pt(r){return new ht(r??"")}class bt extends l{static[n]="PgNumericBuilder";constructor(e,t,i){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=i}build(e){return new wt(e,this.config)}}class wt extends u{static[n]="PgNumeric";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}mapFromDriverValue(e){return typeof e=="string"?e:String(e)}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}class St extends l{static[n]="PgNumericNumberBuilder";constructor(e,t,i){super(e,"number","PgNumericNumber"),this.config.precision=t,this.config.scale=i}build(e){return new Bt(e,this.config)}}class Bt extends u{static[n]="PgNumericNumber";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}mapToDriverValue=String;getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}class Tt extends l{static[n]="PgNumericBigIntBuilder";constructor(e,t,i){super(e,"bigint","PgNumericBigInt"),this.config.precision=t,this.config.scale=i}build(e){return new Nt(e,this.config)}}class Nt extends u{static[n]="PgNumericBigInt";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}function xt(r,e){const{name:t,config:i}=P(r,e),o=i?.mode;return o==="number"?new St(t,i?.precision,i?.scale):o==="bigint"?new Tt(t,i?.precision,i?.scale):new bt(t,i?.precision,i?.scale)}class Dt extends l{static[n]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new Ct(e,this.config)}}class Ct extends u{static[n]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){const[t,i]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(i)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}}class Vt extends l{static[n]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new vt(e,this.config)}}class vt extends u{static[n]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){const[t,i]=e.slice(1,-1).split(",");return{x:Number.parseFloat(t),y:Number.parseFloat(i)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}function It(r,e){const{name:t,config:i}=P(r,e);return!i?.mode||i.mode==="tuple"?new Dt(t):new Vt(t)}function Ft(r){const e=[];for(let t=0;t<r.length;t+=2)e.push(Number.parseInt(r.slice(t,t+2),16));return new Uint8Array(e)}function R(r,e){const t=new ArrayBuffer(8),i=new DataView(t);for(let o=0;o<8;o++)i.setUint8(o,r[e+o]);return i.getFloat64(0,!0)}function ie(r){const e=Ft(r);let t=0;const i=e[t];t+=1;const o=new DataView(e.buffer),a=o.getUint32(t,i===1);if(t+=4,a&536870912&&(o.getUint32(t,i===1),t+=4),(a&65535)===1){const p=R(e,t);t+=8;const y=R(e,t);return t+=8,[p,y]}throw new Error("Unsupported geometry type")}class zt extends l{static[n]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new Lt(e,this.config)}}class Lt extends u{static[n]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return ie(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}}class Qt extends l{static[n]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new $t(e,this.config)}}class $t extends u{static[n]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){const t=ie(e);return{x:t[0],y:t[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}function At(r,e){const{name:t,config:i}=P(r,e);return!i?.mode||i.mode==="tuple"?new zt(t):new Qt(t)}class qt extends l{static[n]="PgRealBuilder";constructor(e,t){super(e,"number","PgReal"),this.config.length=t}build(e){return new _t(e,this.config)}}class _t extends u{static[n]="PgReal";constructor(e,t){super(e,t)}getSQLType(){return"real"}mapFromDriverValue=e=>typeof e=="string"?Number.parseFloat(e):e}function Ot(r){return new qt(r??"")}class jt extends l{static[n]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Ut(e,this.config)}}class Ut extends u{static[n]="PgSerial";getSQLType(){return"serial"}}function Kt(r){return new jt(r??"")}class Et extends F{static[n]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new Jt(e,this.config)}}class Jt extends u{static[n]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>typeof e=="string"?Number(e):e}function Gt(r){return new Et(r??"")}class Mt extends l{static[n]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Rt(e,this.config)}}class Rt extends u{static[n]="PgSmallSerial";getSQLType(){return"smallserial"}}function Ht(r){return new Mt(r??"")}class Wt extends l{static[n]="PgTextBuilder";constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new Xt(e,this.config)}}class Xt extends u{static[n]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}function c(r,e={}){const{name:t,config:i}=P(r,e);return new Wt(t,i)}class Yt extends C{constructor(e,t,i){super(e,"string","PgTime"),this.withTimezone=t,this.precision=i,this.config.withTimezone=t,this.config.precision=i}static[n]="PgTimeBuilder";build(e){return new Zt(e,this.config)}}class Zt extends u{static[n]="PgTime";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}function kt(r,e={}){const{name:t,config:i}=P(r,e);return new Yt(t,i.withTimezone??!1,i.precision)}class er extends C{static[n]="PgTimestampBuilder";constructor(e,t,i){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=i}build(e){return new tr(e,this.config)}}class tr extends u{static[n]="PgTimestamp";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()}class rr extends C{static[n]="PgTimestampStringBuilder";constructor(e,t,i){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=i}build(e){return new ir(e,this.config)}}class ir extends u{static[n]="PgTimestampString";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}function S(r,e={}){const{name:t,config:i}=P(r,e);return i?.mode==="string"?new rr(t,i.withTimezone??!1,i.precision):new er(t,i?.withTimezone??!1,i?.precision)}class nr extends l{static[n]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(I`gen_random_uuid()`)}build(e){return new sr(e,this.config)}}class sr extends u{static[n]="PgUUID";getSQLType(){return"uuid"}}function or(r){return new nr(r??"")}class ar extends l{static[n]="PgVarcharBuilder";constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new ur(e,this.config)}}class ur extends u{static[n]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}function lr(r,e={}){const{name:t,config:i}=P(r,e);return new ar(t,i)}class cr extends l{static[n]="PgBinaryVectorBuilder";constructor(e,t){super(e,"string","PgBinaryVector"),this.config.dimensions=t.dimensions}build(e){return new mr(e,this.config)}}class mr extends u{static[n]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}function gr(r,e){const{name:t,config:i}=P(r,e);return new cr(t,i)}class dr extends l{static[n]="PgHalfVectorBuilder";constructor(e,t){super(e,"array","PgHalfVector"),this.config.dimensions=t.dimensions}build(e){return new pr(e,this.config)}}class pr extends u{static[n]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(t=>Number.parseFloat(t))}}function fr(r,e){const{name:t,config:i}=P(r,e);return new dr(t,i)}class hr extends l{static[n]="PgSparseVectorBuilder";constructor(e,t){super(e,"string","PgSparseVector"),this.config.dimensions=t.dimensions}build(e){return new yr(e,this.config)}}class yr extends u{static[n]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}}function Pr(r,e){const{name:t,config:i}=P(r,e);return new hr(t,i)}class br extends l{static[n]="PgVectorBuilder";constructor(e,t){super(e,"array","PgVector"),this.config.dimensions=t.dimensions}build(e){return new wr(e,this.config)}}class wr extends u{static[n]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(t=>Number.parseFloat(t))}}function Sr(r,e){const{name:t,config:i}=P(r,e);return new br(t,i)}function Br(){return{bigint:Te,bigserial:Ve,boolean:re,char:Le,cidr:Ae,customType:Oe,date:Je,doublePrecision:Re,inet:Xe,integer:_,interval:tt,json:nt,jsonb:at,line:gt,macaddr:ft,macaddr8:Pt,numeric:xt,point:It,geometry:At,real:Ot,serial:Kt,smallint:Gt,smallserial:Ht,text:c,time:kt,timestamp:S,uuid:or,varchar:lr,bit:gr,halfvec:fr,sparsevec:Pr,vector:Sr}}const O=Symbol.for("drizzle:PgInlineForeignKeys"),H=Symbol.for("drizzle:EnableRLS");class V extends b{static[n]="PgTable";static Symbol=Object.assign({},b.Symbol,{InlineForeignKeys:O,EnableRLS:H});[O]=[];[H]=!1;[b.Symbol.ExtraConfigBuilder]=void 0;[b.Symbol.ExtraConfigColumns]={}}function Tr(r,e,t,i,o=r){const a=new V(r,i,o),p=typeof e=="function"?e(Br()):e,y=Object.fromEntries(Object.entries(p).map(([s,m])=>{const d=m;d.setName(s);const N=d.build(a);return a[O].push(...d.buildForeignKeys(N,a)),[s,N]})),g=Object.fromEntries(Object.entries(p).map(([s,m])=>{const d=m;d.setName(s);const N=d.buildExtraConfigColumn(a);return[s,N]})),f=Object.assign(a,y);return f[b.Symbol.Columns]=y,f[b.Symbol.ExtraConfigColumns]=g,t&&(f[V.Symbol.ExtraConfigBuilder]=t),Object.assign(f,{enableRLS:()=>(f[V.Symbol.EnableRLS]=!0,f)})}const T=(r,e,t)=>Tr(r,e,t,void 0);function Nr(...r){return r[0].columns?new W(r[0].columns,r[0].name):new W(r)}class W{static[n]="PgPrimaryKeyBuilder";columns;name;constructor(e,t){this.columns=e,this.name=t}build(e){return new xr(e,this.columns,this.name)}}class xr{constructor(e,t,i){this.table=e,this.columns=t,this.name=i}static[n]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[V.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}}const z=T("user",{id:c("id").primaryKey(),name:c("name").notNull(),email:c("email").notNull().unique(),emailVerified:re("email_verified").$defaultFn(()=>!1).notNull(),image:c("image"),createdAt:S("created_at").$defaultFn(()=>new Date).notNull(),updatedAt:S("updated_at").$defaultFn(()=>new Date).notNull()});T("session",{id:c("id").primaryKey(),expiresAt:S("expires_at").notNull(),token:c("token").notNull().unique(),createdAt:S("created_at").notNull(),updatedAt:S("updated_at").notNull(),ipAddress:c("ip_address"),userAgent:c("user_agent"),userId:c("user_id").notNull().references(()=>z.id,{onDelete:"cascade"})});T("account",{id:c("id").primaryKey(),accountId:c("account_id").notNull(),providerId:c("provider_id").notNull(),userId:c("user_id").notNull().references(()=>z.id,{onDelete:"cascade"}),accessToken:c("access_token"),refreshToken:c("refresh_token"),idToken:c("id_token"),accessTokenExpiresAt:S("access_token_expires_at"),refreshTokenExpiresAt:S("refresh_token_expires_at"),scope:c("scope"),password:c("password"),createdAt:S("created_at").notNull(),updatedAt:S("updated_at").notNull()});T("verification",{id:c("id").primaryKey(),identifier:c("identifier").notNull(),value:c("value").notNull(),expiresAt:S("expires_at").notNull(),createdAt:S("created_at").$defaultFn(()=>new Date),updatedAt:S("updated_at").$defaultFn(()=>new Date)});const Dr=T("track",{id:c("id").primaryKey(),owner:c("owner").notNull().references(()=>z.id,{onDelete:"no action"}),title:c("title").notNull(),artist:c("artist").notNull(),album:c("album"),blob:c("blob").notNull().unique(),length:_("length").notNull(),size:_("size").notNull()}),Cr=T("playlist",{id:c("id").primaryKey(),owner:c("owner").notNull().references(()=>z.id,{onDelete:"cascade"}),image:c("image").unique(),name:c("name").notNull()});T("playlist_to_track",{playlistId:c("playlist_id").notNull().references(()=>Cr.id,{onDelete:"cascade"}),trackId:c("track_id").notNull().references(()=>Dr.id,{onDelete:"cascade"})},r=>[Nr({columns:[r.playlistId,r.trackId]})]);
