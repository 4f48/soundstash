---
import LibraryComponent from "@/components/library";
import Layout from "@/layouts/player.astro";
import { db } from "@/lib/database";
import { eq } from "drizzle-orm";
import { track } from "drizzle/schema";

const user = Astro.locals.user;
if (!user) return new Response(null, { status: 401 });

const tracks = await db.query.track.findMany({
	where: eq(track.owner, user.id),
});
---

<Layout>
	<LibraryComponent initialTracks={tracks} client:load />
</Layout>
